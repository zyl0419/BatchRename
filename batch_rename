import os
import tkinter as tk
from tkinter import filedialog, messagebox


def batch_rename_ui():
    # 获取输入框的值
    folder_path = entry_path.get()
    try:
        start_num = int(entry_start.get())
    except ValueError:
        messagebox.showerror("错误", "起始编号必须是数字！")
        return

    if not folder_path or not os.path.isdir(folder_path):
        messagebox.showerror("错误", "请先选择有效的文件夹！")
        return

    # 你的核心逻辑
    try:
        files = [f for f in os.listdir(folder_path) if os.path.isfile(os.path.join(folder_path, f))]
        files.sort()

        count = 0
        for filename in files:
            extension = os.path.splitext(filename)[1]
            new_name = f"{start_num + count:04d}{extension}"

            old_path = os.path.join(folder_path, filename)
            new_path = os.path.join(folder_path, new_name)

            # 防止文件名冲突（比如新旧文件名一样时）
            if old_path != new_path:
                os.rename(old_path, new_path)
            count += 1

        messagebox.showinfo("成功", f"处理完成！\n重命名了 {count} 个文件。")
    except Exception as e:
        messagebox.showerror("失败", f"发生错误: {e}")


def select_folder():
    path = filedialog.askdirectory()
    if path:
        entry_path.delete(0, tk.END)
        entry_path.insert(0, path)


# --- UI 界面设置 ---
root = tk.Tk()
root.title("批量文件重命名工具")
root.geometry("400x200")

# 文件夹选择
tk.Label(root, text="目标文件夹:").pack(pady=5)
frame_path = tk.Frame(root)
frame_path.pack()
entry_path = tk.Entry(frame_path, width=40)
entry_path.pack(side=tk.LEFT, padx=5)
tk.Button(frame_path, text="浏览", command=select_folder).pack(side=tk.LEFT)

# 起始编号
tk.Label(root, text="起始编号 (如 1):").pack(pady=5)
entry_start = tk.Entry(root, width=10)
entry_start.insert(0, "1")
entry_start.pack()

# 执行按钮
tk.Button(root, text="开始重命名", command=batch_rename_ui, bg="#4CAF50", fg="white", width=20).pack(pady=20)

root.mainloop()
